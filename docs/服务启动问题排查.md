# æœåŠ¡å¯åŠ¨é—®é¢˜æ’æŸ¥

## âŒ é—®é¢˜ï¼šè®¿é—®ç½‘ç«™æ˜¾ç¤º nginx é»˜è®¤é¡µé¢

### é—®é¢˜æè¿°

è®¿é—® `http://1.15.29.168` æ—¶ï¼Œçœ‹åˆ°çš„æ˜¯ nginx çš„é»˜è®¤æ¬¢è¿é¡µé¢ï¼Œè€Œä¸æ˜¯é¡¹ç›®çš„å‰ç«¯é¡µé¢ã€‚

### åŸå› 

- Docker å®¹å™¨æ²¡æœ‰å¯åŠ¨
- ç³»ç»Ÿè‡ªå¸¦çš„ nginx å ç”¨äº† 80 ç«¯å£
- å‰ç«¯å®¹å™¨æ²¡æœ‰æ­£ç¡®è¿è¡Œ

### è§£å†³æ–¹æ¡ˆ

#### æ­¥éª¤ 1ï¼šæ£€æŸ¥ Docker æœåŠ¡çŠ¶æ€

```bash
# æ£€æŸ¥å®¹å™¨æ˜¯å¦è¿è¡Œ
docker compose ps

# æˆ–è€…
docker ps
```

#### æ­¥éª¤ 2ï¼šæ£€æŸ¥ç«¯å£å ç”¨

```bash
# æ£€æŸ¥ 80 ç«¯å£å ç”¨
sudo netstat -tlnp | grep :80

# æ£€æŸ¥ 8080 ç«¯å£å ç”¨
sudo netstat -tlnp | grep :8080
```

#### æ­¥éª¤ 3ï¼šåœæ­¢ç³»ç»Ÿ nginxï¼ˆå¦‚æœå ç”¨ 80 ç«¯å£ï¼‰

```bash
# æ£€æŸ¥ç³»ç»Ÿ nginx çŠ¶æ€
sudo systemctl status nginx

# å¦‚æœæ­£åœ¨è¿è¡Œï¼Œåœæ­¢å®ƒ
sudo systemctl stop nginx

# ç¦ç”¨å¼€æœºè‡ªå¯ï¼ˆå¯é€‰ï¼‰
sudo systemctl disable nginx
```

#### æ­¥éª¤ 4ï¼šå¯åŠ¨ Docker æœåŠ¡

```bash
# ç¡®ä¿åœ¨é¡¹ç›®ç›®å½•
cd /opt/colorful-tibet

# å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker compose up -d

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker compose ps

# æŸ¥çœ‹æ—¥å¿—
docker compose logs -f
```

#### æ­¥éª¤ 5ï¼šéªŒè¯æœåŠ¡å¯åŠ¨

```bash
# æ£€æŸ¥å®¹å™¨æ˜¯å¦è¿è¡Œ
docker compose ps

# åº”è¯¥çœ‹åˆ°ä¸¤ä¸ªå®¹å™¨ï¼š
# - colorful-tibet-backend (è¿è¡Œä¸­)
# - colorful-tibet-frontend (è¿è¡Œä¸­)

# æ£€æŸ¥ç«¯å£ç›‘å¬
sudo netstat -tlnp | grep -E '80|8080'
```

## ğŸ” å®Œæ•´æ’æŸ¥æµç¨‹

```bash
# 1. æ£€æŸ¥ Docker æœåŠ¡
docker compose ps

# 2. å¦‚æœå®¹å™¨æ²¡æœ‰è¿è¡Œï¼Œå¯åŠ¨å®ƒä»¬
cd /opt/colorful-tibet
docker compose up -d

# 3. æ£€æŸ¥å®¹å™¨çŠ¶æ€
docker compose ps

# 4. æŸ¥çœ‹æ—¥å¿—
docker compose logs backend
docker compose logs frontend

# 5. æ£€æŸ¥ç«¯å£å ç”¨
sudo netstat -tlnp | grep -E '80|8080'

# 6. å¦‚æœç³»ç»Ÿ nginx å ç”¨ 80 ç«¯å£ï¼Œåœæ­¢å®ƒ
sudo systemctl stop nginx
sudo systemctl disable nginx

# 7. é‡æ–°å¯åŠ¨ Docker æœåŠ¡
docker compose restart
```

## ğŸš€ å¿«é€Ÿä¿®å¤å‘½ä»¤

```bash
# 1. åœæ­¢ç³»ç»Ÿ nginx
sudo systemctl stop nginx
sudo systemctl disable nginx

# 2. å¯åŠ¨ Docker æœåŠ¡
cd /opt/colorful-tibet
docker compose up -d

# 3. æŸ¥çœ‹çŠ¶æ€
docker compose ps

# 4. æŸ¥çœ‹æ—¥å¿—
docker compose logs -f
```

## âš ï¸ å¸¸è§é—®é¢˜

### é—®é¢˜ 1ï¼šç«¯å£è¢«å ç”¨

å¦‚æœ 80 ç«¯å£è¢«ç³»ç»Ÿ nginx å ç”¨ï¼š

```bash
# åœæ­¢ç³»ç»Ÿ nginx
sudo systemctl stop nginx
sudo systemctl disable nginx

# é‡æ–°å¯åŠ¨ Docker æœåŠ¡
docker compose restart
```

### é—®é¢˜ 2ï¼šå®¹å™¨å¯åŠ¨å¤±è´¥

```bash
# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
docker compose logs backend
docker compose logs frontend

# æ£€æŸ¥å®¹å™¨çŠ¶æ€
docker compose ps -a

# å¦‚æœå®¹å™¨é€€å‡ºï¼ŒæŸ¥çœ‹é€€å‡ºåŸå› 
docker compose ps -a
docker inspect colorful-tibet-frontend
docker inspect colorful-tibet-backend
```

### é—®é¢˜ 3ï¼šæ„å»ºæœªå®Œæˆ

å¦‚æœå®¹å™¨æ²¡æœ‰æ„å»ºï¼š

```bash
# é‡æ–°æ„å»º
docker compose build

# å¯åŠ¨æœåŠ¡
docker compose up -d
```

## ğŸ“ éªŒè¯æ¸…å•

- âœ… Docker æœåŠ¡æ­£åœ¨è¿è¡Œï¼š`docker compose ps`
- âœ… å‰ç«¯å®¹å™¨è¿è¡Œä¸­ï¼š`colorful-tibet-frontend` çŠ¶æ€ä¸º `Up`
- âœ… åç«¯å®¹å™¨è¿è¡Œä¸­ï¼š`colorful-tibet-backend` çŠ¶æ€ä¸º `Up`
- âœ… 80 ç«¯å£è¢« Docker å®¹å™¨å ç”¨ï¼š`sudo netstat -tlnp | grep :80`
- âœ… 8080 ç«¯å£è¢«åç«¯å®¹å™¨å ç”¨ï¼š`sudo netstat -tlnp | grep :8080`
- âœ… ç³»ç»Ÿ nginx å·²åœæ­¢ï¼š`sudo systemctl status nginx`ï¼ˆåº”è¯¥æ˜¾ç¤º inactiveï¼‰

## ğŸ¯ æˆåŠŸæ ‡å¿—

å½“ä¸€åˆ‡æ­£å¸¸æ—¶ï¼š
- è®¿é—® `http://1.15.29.168` åº”è¯¥çœ‹åˆ°é¡¹ç›®å‰ç«¯é¡µé¢ï¼ˆä¸æ˜¯ nginx é»˜è®¤é¡µé¢ï¼‰
- è®¿é—® `http://1.15.29.168:8080/api/spots` åº”è¯¥è¿”å› JSON æ•°æ®
- `docker compose ps` æ˜¾ç¤ºä¸¤ä¸ªå®¹å™¨éƒ½åœ¨è¿è¡Œ

